import{_ as h}from"./card-header-btn2-3eeFV3jL.js";import{_ as q}from"./CommonModal-DAUXa4tk.js";import{s as S,a as s}from"./index-DzeG4XAE.js";import{a as f}from"./index-NIGUFBhG.js";import{_ as $}from"./SnackBar-HH3n22ps.js";import{u as C}from"./useSnackBar-IN_qynCK.js";import{m as I,r as u,M as U,c as B,o as M,b as e,w as r,N as F,Q as L,T as _,U as N,p as Q,ac as y,a0 as T,d as b,u as n,t as D,F as z}from"./index-vUQOwfGq.js";const K={__name:"productInsert",setup(E){I(()=>{});const{snackBar:o}=C(),m=u(!1),d=u(null),i=u(null),v=u([]),p=t=>t.exam_qty-t.bnt,V=U(()=>v.value.filter(t=>p(t)>0)),x=async()=>{try{const t={item_id:d.value},a=await f.get("/api/insertList",{params:t});v.value=a.data}catch{o("조회 실패.","error")}},w=async()=>{try{return(await f.get("/api/itemModal1")).data}catch{return o("조회 실패.","error"),[]}},k=async()=>{if(!i.value||i.value.length===0){o("입고할 제품을 선택해주세요.","warning");return}for(let t of i.value){const a=p(t);if(!t.qty||t.qty<=0){o("입고수량은 0보다 커야 합니다.","warning");return}if(t.qty>a){o(`입고수량이 입고가능수량(${a})보다 많습니다.`,"error");return}}if(confirm("입고하시겠습니까?"))try{let t=i.value.map(l=>({item_id:l.item_id,qty:l.qty,remk:l.remk,exam_id:l.exam_id}));(await f.post("/api/productInsert",t)).data.result?(o("입고 완료","success"),i.value=null):o("등록 실패.","error")}catch(t){console.log(t),o("에러","error")}},g=t=>{d.value=t.item_id};return(t,a)=>(M(),B(z,null,[e(_,null,{default:r(()=>[e(F,{elevation:"10"},{default:r(()=>[e(L,{class:"py-6 px-6"},{default:r(()=>[e(h,{title:"입고 관리","btn-text1":"조회","btn-variant1":"flat","btn-color1":"primary",onBtnClick1:a[0]||(a[0]=l=>x()),"btn-text2":"입고","btn-variant2":"flat","btn-color2":"warning",onBtnClick2:a[1]||(a[1]=l=>k())})]),_:1}),e(_,{"no-gutters":""},{default:r(()=>[e(N,{cols:"12",sm:"4"},{default:r(()=>[e(Q,{class:"pa-2 ma-2"},{default:r(()=>[e(y,{variant:"outlined",label:"제품코드 검색",modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=l=>d.value=l)},{"append-inner":r(()=>[e(T,{onClick:a[2]||(a[2]=l=>m.value=!0),class:"cursor-pointer"},{default:r(()=>a[6]||(a[6]=[b("mdi-magnify")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n(S),{value:V.value,tableStyle:"min-width: 50rem",selection:i.value,"onUpdate:selection":a[4]||(a[4]=l=>i.value=l),class:"cursor-pointer",paginator:"",rows:5},{default:r(()=>[e(n(s),{selectionMode:"multiple",headerStyle:"width: 3rem"}),e(n(s),{field:"item_id",header:"제품코드"}),e(n(s),{field:"item_name",header:"제품명"}),e(n(s),{field:"item_type",header:"제품유형"}),e(n(s),{field:"exam_qty",header:"수량"}),e(n(s),{header:"입고가능수량"},{body:r(({data:l})=>[b(D(p(l)),1)]),_:1}),e(n(s),{header:"입고수량",style:{width:"120px"}},{body:r(({data:l})=>[e(y,{type:"number",dense:"","hide-details":"",style:{width:"100px"},variant:"outlined",min:"0",modelValue:l.qty,"onUpdate:modelValue":c=>l.qty=c},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(n(s),{header:"비고",style:{width:"110px"}},{body:r(({data:l})=>[e(y,{type:"text",dense:"","hide-details":"",style:{width:"120px"},variant:"outlined",min:"0",modelValue:l.remk,"onUpdate:modelValue":c=>l.remk=c},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value","selection"])]),_:1})]),_:1}),e(q,{visible:m.value,title:"제품코드",idField:"item_id",columns:[{key:"item_id",label:"제품코드"},{key:"item_type",label:"제품유형"},{key:"item_name",label:"제품명"}],fetchData:w,pageSize:5,onSelect:g,onClose:a[5]||(a[5]=l=>m.value=!1)},null,8,["visible"]),e($)],64))}};export{K as default};

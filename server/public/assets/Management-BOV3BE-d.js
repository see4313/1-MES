import{a as c}from"./index-NIGUFBhG.js";import{_ as te}from"./card-header-btn2-3eeFV3jL.js";import{_ as ne}from"./card-header-btn3k-6zMLpEnU.js";import{s as ue,a as r}from"./index-DzeG4XAE.js";import{_ as L}from"./CommonModal-DAUXa4tk.js";import{u as ie}from"./useSnackBar-IN_qynCK.js";import{u as oe}from"./useFormatDate-DuO0KNBS.js";import{r as u,D as se,c as de,o as re,b as l,w as n,Q as P,T as U,U as o,ac as s,a0 as x,d as y,N as j,y as me,u as i,al as ve,t as fe,am as pe,an as ce,F as ye}from"./index-vUQOwfGq.js";const xe={__name:"Management",setup(_e){const{formatDate:q}=oe(),{snackOpen:S,snackMessage:O,snackColor:W}=ie();function m(a,e="success"){O.value=a,W.value=e,S.value=!0}const z=new Date().toISOString().split("T")[0],D=u(""),M=u(""),T=u(""),v=u(""),$=u(""),f=u(""),E=u([]),R=u(null),d=u(""),p=u(""),_=u(""),Q=u(""),V=u(""),b=u(""),k=u(""),C=u(""),I=u(""),g=u(""),w=u(""),F=u(!1),N=u(!1),B=u(!1);function A(){D.value="",M.value="",T.value="",v.value="",$.value="",f.value=""}function K(){d.value="",p.value="",_.value="",Q.value="",V.value="",b.value="",k.value="",C.value="",I.value="",g.value="",w.value="",v.value="",f.value=""}async function H(){try{const a={facility_id:M.value,facility_type:v.value,emp_id:f.value},e=await c.get("/api/facilityList",{params:a});E.value=e.data}catch(a){console.error("조회 실패",a)}}se(R,a=>{a&&(d.value=a.facility_id||"",p.value=a.facility_nm||"",_.value=a.facility_type_name||"",Q.value=a.facility_cnt||"",V.value=a.emp_name||"",b.value=a.purchase_dt||"",k.value=a.temp_val||"",C.value=a.humidity_val||"",I.value=a.rpm_val||"",g.value=a.power_val||"",w.value=a.remk||"",a.facility_type&&(v.value=a.facility_type),a.emp_id&&(f.value=a.emp_id))});const G=async()=>(await c.get("/api/itemNames")).data,J=async()=>(await c.get("/api/itemTypes")).data,X=async()=>(await c.get("/api/users")).data;function Y(a){D.value=a.item_name,M.value=a.item_id,p.value=a.item_name}function Z(a){T.value=a.type_name,v.value=a.type_id,_.value=a.type_name}function h(a){$.value=a.user_name,f.value=a.user_id,V.value=a.user_name}const ee=async()=>{if(!p.value||!v.value||!f.value){m("필수 값을 입력하세요","error");return}if(!confirm(d.value?"정말 수정하시겠습니까?":"정말 저장하시겠습니까?"))return;let a={facility_id:d.value||null,facility_nm:p.value,facility_type:v.value,emp_id:f.value,purchase_dt:q(b.value,"-"),temp_val:k.value,humidity_val:C.value,rpm_val:I.value,power_val:g.value,remk:w.value};try{let e;d.value?(e=await c.put("/api/facilityUpdate",a),e.data.success&&m("수정되었습니다","warning")):(e=await c.post("/api/facilityInsert",a),e.data.success&&m("저장되었습니다","success")),await H(),K()}catch(e){console.error(e),m("저장 실패","error")}},le=async()=>{if(!d.value){m("삭제할 데이터를 선택하세요","warning");return}if(confirm("정말 삭제하시겠습니까?"))try{(await c.delete("/api/facilityDelete",{data:{facility_id:d.value}})).data.success&&(m("삭제되었습니다.","error"),await H(),K())}catch(a){console.error(a),m("삭제 실패","error")}};return(a,e)=>{const ae=me("CardHeader");return re(),de(ye,null,[l(j,{elevation:"10"},{default:n(()=>[l(P,{class:"py-6 px-6"},{default:n(()=>[l(te,{title:"설비 조회","btn-text1":"초기화","btn-variant1":"flat","btn-color1":"secondary",onBtnClick1:A,"btn-text2":"조회","btn-variant2":"flat","btn-color2":"primary",onBtnClick2:H}),l(U,null,{default:n(()=>[l(o,{cols:"12",md:"12"},{default:n(()=>[l(U,{justify:"space-between",dense:""},{default:n(()=>[l(o,{cols:"12",sm:"3"},{default:n(()=>[l(s,{label:"설비명",modelValue:D.value,"onUpdate:modelValue":e[1]||(e[1]=t=>D.value=t),variant:"outlined",readonly:""},{"append-inner":n(()=>[l(x,{onClick:e[0]||(e[0]=t=>F.value=!0),class:"cursor-pointer"},{default:n(()=>e[23]||(e[23]=[y("mdi-magnify")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(o,{cols:"12",sm:"3"},{default:n(()=>[l(s,{label:"설비유형",modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=t=>T.value=t),variant:"outlined",readonly:""},{"append-inner":n(()=>[l(x,{onClick:e[2]||(e[2]=t=>N.value=!0),class:"cursor-pointer"},{default:n(()=>e[24]||(e[24]=[y("mdi-magnify")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(o,{cols:"12",sm:"3"},{default:n(()=>[l(s,{label:"담당자",modelValue:$.value,"onUpdate:modelValue":e[5]||(e[5]=t=>$.value=t),variant:"outlined",readonly:""},{"append-inner":n(()=>[l(x,{onClick:e[4]||(e[4]=t=>B.value=!0),class:"cursor-pointer"},{default:n(()=>e[25]||(e[25]=[y("mdi-magnify")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(j,{elevation:"10",class:"mt-3"},{default:n(()=>[l(P,{class:"py-6 px-6"},{default:n(()=>[l(ae,{title:"설비목록"}),l(i(ue),{selection:R.value,"onUpdate:selection":e[6]||(e[6]=t=>R.value=t),value:E.value,selectionMode:"single",metaKeySelection:!1,dataKey:"facility_id",paginator:"",rows:5,tableStyle:"min-width: 50rem",class:"cursor-pointer"},{default:n(()=>[l(i(r),{field:"facility_id",header:"설비ID"}),l(i(r),{field:"facility_nm",header:"설비명"}),l(i(r),{field:"facility_type_name",header:"설비유형"}),l(i(r),{field:"emp_name",header:"담당자"}),l(i(r),{field:"purchase_dt",header:"구매일자"}),l(i(r),{field:"temp_val",header:"적정 온도(C)"}),l(i(r),{field:"humidity_val",header:"적정 습도(%)"}),l(i(r),{field:"rpm_val",header:"적정 RPM"}),l(i(r),{field:"power_val",header:"적정 전력량(KW)"}),l(i(r),{field:"remk",header:"비고"})]),_:1},8,["selection","value"])]),_:1})]),_:1}),l(j,{elevation:"10",class:"mt-3"},{default:n(()=>[l(P,{class:"py-6 px-6"},{default:n(()=>[l(ne,{title:"설비등록","btn-text1":"초기화","btn-variant1":"flat","btn-color1":"secondary",onBtnClick1:K,"btn-text2":"삭제","btn-variant2":"flat","btn-color2":"error","btn-disabled2":!d.value,onBtnClick2:le,"btn-text3":"저장","btn-variant3":"flat","btn-color3":"primary",onBtnClick3:ee},null,8,["btn-disabled2"]),l(U,{dense:""},{default:n(()=>[l(o,{cols:"12",sm:"4"},{default:n(()=>[l(s,{label:"설비ID",modelValue:d.value,"onUpdate:modelValue":e[7]||(e[7]=t=>d.value=t),variant:"outlined",readonly:""},null,8,["modelValue"])]),_:1}),l(o,{cols:"12",sm:"4"},{default:n(()=>[l(s,{label:"설비명",modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=t=>p.value=t),variant:"outlined"},null,8,["modelValue"])]),_:1}),l(o,{cols:"12",sm:"4"},{default:n(()=>[l(s,{label:"설비유형",modelValue:_.value,"onUpdate:modelValue":e[10]||(e[10]=t=>_.value=t),variant:"outlined",readonly:""},{"append-inner":n(()=>[l(x,{onClick:e[9]||(e[9]=t=>N.value=!0),class:"cursor-pointer"},{default:n(()=>e[26]||(e[26]=[y("mdi-magnify")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(U,{dense:""},{default:n(()=>[l(o,{cols:"12",sm:"4"},{default:n(()=>[l(s,{label:"담당자",modelValue:V.value,"onUpdate:modelValue":e[12]||(e[12]=t=>V.value=t),variant:"outlined",readonly:""},{"append-inner":n(()=>[l(x,{onClick:e[11]||(e[11]=t=>B.value=!0),class:"cursor-pointer"},{default:n(()=>e[27]||(e[27]=[y("mdi-magnify")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(o,{cols:"12",sm:"4"},{default:n(()=>[l(s,{type:"date",label:"구매일자",modelValue:b.value,"onUpdate:modelValue":e[13]||(e[13]=t=>b.value=t),max:i(z),variant:"outlined"},null,8,["modelValue","max"])]),_:1})]),_:1}),l(U,{dense:""},{default:n(()=>[l(o,{cols:"12",sm:"3"},{default:n(()=>[l(s,{label:"적정온도",modelValue:k.value,"onUpdate:modelValue":e[14]||(e[14]=t=>k.value=t),variant:"outlined"},null,8,["modelValue"])]),_:1}),l(o,{cols:"12",sm:"3"},{default:n(()=>[l(s,{label:"적정습도(%)",modelValue:C.value,"onUpdate:modelValue":e[15]||(e[15]=t=>C.value=t),variant:"outlined"},null,8,["modelValue"])]),_:1}),l(o,{cols:"12",sm:"3"},{default:n(()=>[l(s,{label:"적정RPM",modelValue:I.value,"onUpdate:modelValue":e[16]||(e[16]=t=>I.value=t),variant:"outlined"},null,8,["modelValue"])]),_:1}),l(o,{cols:"12",sm:"3"},{default:n(()=>[l(s,{label:"적정 전력량(KW)",modelValue:g.value,"onUpdate:modelValue":e[17]||(e[17]=t=>g.value=t),variant:"outlined"},null,8,["modelValue"])]),_:1}),l(o,{cols:"12"},{default:n(()=>[l(ve,{label:"비고",modelValue:w.value,"onUpdate:modelValue":e[18]||(e[18]=t=>w.value=t),outlined:"",rows:"5"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(L,{visible:F.value,title:"설비명",idField:"item_id",columns:[{key:"item_id",label:"ID"},{key:"item_name",label:"명"}],fetchData:G,onSelect:Y,onClose:e[19]||(e[19]=t=>F.value=!1)},null,8,["visible"]),l(L,{visible:N.value,title:"설비유형",idField:"type_id",columns:[{key:"type_name",label:"유형"}],fetchData:J,onSelect:Z,onClose:e[20]||(e[20]=t=>N.value=!1)},null,8,["visible"]),l(L,{visible:B.value,title:"담당자",idField:"user_id",columns:[{key:"user_id",label:"ID"},{key:"user_name",label:"이름"}],fetchData:X,onSelect:h,onClose:e[21]||(e[21]=t=>B.value=!1)},null,8,["visible"]),l(ce,{modelValue:i(S),"onUpdate:modelValue":e[22]||(e[22]=t=>pe(S)?S.value=t:null),color:i(W),timeout:"2000",location:"top right"},{default:n(()=>[y(fe(i(O)),1)]),_:1},8,["modelValue","color"])],64)}}};export{xe as default};

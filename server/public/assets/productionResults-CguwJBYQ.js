import{r,bE as tt,M as Q,D as et,c as lt,o as D,e as R,b as e,w as a,N,K as F,Q as I,u as n,d as c,t as i,U as u,T as S,W as L,a as l,ac as x,a0 as h,aj as U,V as k,v as at,a6 as st,af as ot,F as it}from"./index-vUQOwfGq.js";import{a as V}from"./index-NIGUFBhG.js";import{s as dt,a as m}from"./index-DzeG4XAE.js";import{_ as B}from"./card-header-BG8Zbe1P.js";import{_ as j}from"./CommonModal-DAUXa4tk.js";import{_ as nt}from"./SnackBar-HH3n22ps.js";import{u as ut}from"./useSnackBar-IN_qynCK.js";import{u as rt}from"./useFormatDate-DuO0KNBS.js";import{_ as ct}from"./_plugin-vue_export-helper-DlAUqK2U.js";const mt={class:"text-subtitle-1"},ft={class:"text-subtitle-1"},pt={class:"text-subtitle-1"},vt={class:"text-subtitle-1"},bt={class:"text-subtitle-1"},yt={class:"text-subtitle-1"},xt={class:"text-subtitle-1"},gt={class:"text-center mb-4"},_t={class:"text-subtitle-1"},wt={class:"text-subtitle-1"},Nt={class:"text-subtitle-1"},kt={class:"text-subtitle-1"},Vt={class:"text-subtitle-1"},Ct={class:"text-subtitle-1"},Qt={__name:"productionResults",setup(Dt){const{snackBar:f}=ut(),{formatDate:M}=rt(),s=r({}),A=r(!1),v=r({}),g=r(!1),b=r({}),_=r(!1),C=r([]),p=r(0),y=r(!1),E=async()=>{try{const{data:o}=await V.get("/api/prod/getstatuszeroprodlist");C.value=o??[]}catch(o){console.error(o),C.value=[]}};tt(E);const w=o=>(o??0).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),O=Q(()=>w(p.value)),K=o=>{const t=Number(o.replace(/,/g,""))||0,d=s.value.drctQty||0;t>d?(p.value=d,f("불량 수량은 투입 수량을 초과할 수 없습니다.","warning")):p.value=t},$=Q(()=>(s.value.drctQty||0)-(p.value||0)),T=Q(()=>w($.value));et(()=>s.value.prodNo,()=>{v.value={},p.value=0,b.value={}});const z=()=>{g.value=!0},P=()=>{_.value=!0},W=({data:o})=>{s.value={...o},A.value=!1},q=async()=>{const{prcsNumber:o}=s.value;try{const{data:t}=await V.get(`/api/prod/getfacilitybyname/${o}`);return t??[]}catch{return[]}},G=o=>{v.value={...o},g.value=!1},H=async()=>{try{const{data:o}=await V.get("/api/selectEmp",{params:{dept_id:"D001"}});return o??[]}catch{return[]}},J=o=>{b.value={...o},_.value=!1},X=()=>{var o,t,d;if(!((o=s.value)!=null&&o.prodNo))return f("생산 지시건을 선택해주세요.","warning");if(!((t=v.value)!=null&&t.facilityId))return f("설비를 선택해주세요.","warning");if(!((d=b.value)!=null&&d.emp_id))return f("사원을 선택해주세요.","warning");y.value=!0},Y=async()=>{y.value=!1;const o={prodNo:s.value.prodNo,itemId:s.value.itemId,empNo:b.value.emp_id,facilityNo:v.value.facilityId,inputQty:s.value.drctQty,inferQty:p.value,prodQty:$.value,currOpNo:s.value.currentOpNo,remk:""};try{const{data:t}=await V.post("/api/prod/addprodacmslt",o);t.affectedRows>0&&(f("성공적으로 등록되었습니다.","success"),s.value={},E())}catch(t){console.error(t),f("오류가 발생하였습니다.","error")}},Z=()=>{s.value={}};return(o,t)=>(D(),lt(it,null,[s.value.prodNo?(D(),R(S,{key:1},{default:a(()=>[e(u,{cols:"4"},{default:a(()=>[e(N,{elevation:"10"},{default:a(()=>[e(F,{fluid:""},{default:a(()=>[e(I,{class:"py-6 px-6"},{default:a(()=>[e(B,{title:"선택한 생산 지시건"}),e(L,{density:"comfortable",class:"mt-4"},{default:a(()=>[l("tbody",null,[l("tr",null,[t[4]||(t[4]=l("td",{class:"font-weight-medium text-subtitle-1"},"생산 지시 번호",-1)),l("td",mt,i(s.value.instructNo),1)]),l("tr",null,[t[5]||(t[5]=l("td",{class:"font-weight-medium text-subtitle-1"},"세부 지시 번호",-1)),l("td",ft,i(s.value.detaInstructNo),1)]),l("tr",null,[t[6]||(t[6]=l("td",{class:"font-weight-medium text-subtitle-1"},"품목명",-1)),l("td",pt,i(s.value.itemName),1)]),l("tr",null,[t[7]||(t[7]=l("td",{class:"font-weight-medium text-subtitle-1"},"생산 유형",-1)),l("td",vt,i(s.value.itemType),1)]),l("tr",null,[t[8]||(t[8]=l("td",{class:"font-weight-medium text-subtitle-1"},"현재 공정",-1)),l("td",bt,i(s.value.prcsName),1)]),l("tr",null,[t[9]||(t[9]=l("td",{class:"font-weight-medium text-subtitle-1"},"공정 순서",-1)),l("td",yt,"총 "+i(s.value.lastOpNo)+"개 공정 중 "+i(s.value.currentOpNo)+"번째",1)]),l("tr",null,[t[10]||(t[10]=l("td",{class:"font-weight-medium text-subtitle-1"},"지시 일자",-1)),l("td",xt,i(n(M)(s.value.instructDatetime)),1)])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"8"},{default:a(()=>[e(N,{elevation:"10"},{default:a(()=>[e(F,{fluid:""},{default:a(()=>[e(I,{class:"py-6 px-6"},{default:a(()=>[e(B,{title:"생산 실적 등록"}),e(u,{cols:"12",class:"px-2 d-flex align-center"},{default:a(()=>[e(x,{label:"설비 선택","model-value":v.value.facilityName,variant:"outlined",onClick:z,readonly:"","hide-details":""},{"append-inner":a(()=>[e(h,{class:"cursor-pointer",onClick:U(z,["stop"])},{default:a(()=>t[11]||(t[11]=[c("mdi-magnify")])),_:1})]),_:1},8,["model-value"])]),_:1}),e(u,{cols:"12",class:"px-2 d-flex align-center"},{default:a(()=>[e(x,{label:"투입 수량","model-value":w(s.value.drctQty||0),variant:"outlined",readonly:"","hide-details":"",class:"text-right"},null,8,["model-value"])]),_:1}),e(u,{cols:"12",class:"px-2 d-flex align-center"},{default:a(()=>[e(x,{label:"불량 수량","model-value":O.value,"onUpdate:modelValue":K,variant:"outlined","hide-details":"",class:"text-right"},null,8,["model-value"])]),_:1}),e(u,{cols:"12",class:"px-2 d-flex align-center"},{default:a(()=>[e(x,{label:"실제 생산 수량","model-value":T.value,variant:"outlined",readonly:"","hide-details":"",class:"text-right"},null,8,["model-value"])]),_:1}),e(u,{cols:"12",class:"px-2 d-flex align-center"},{default:a(()=>[e(x,{label:"사원 선택","model-value":b.value.emp_name,variant:"outlined",onClick:P,readonly:"","hide-details":""},{"append-inner":a(()=>[e(h,{class:"cursor-pointer",onClick:U(P,["stop"])},{default:a(()=>t[12]||(t[12]=[c("mdi-magnify")])),_:1})]),_:1},8,["model-value"])]),_:1}),e(S,null,{default:a(()=>[e(u,{cols:"4",class:"pt-4 pb-4 pl-4 pr-1 d-flex align-center"},{default:a(()=>[e(k,{color:"secondary",variant:"outlined",onClick:Z,block:""},{default:a(()=>t[13]||(t[13]=[c(" 다시 선택 ")])),_:1})]),_:1}),e(u,{cols:"8",class:"pt-4 pb-4 pl-1 pr-4 d-flex align-center"},{default:a(()=>[e(k,{color:"primary",onClick:X,block:""},{default:a(()=>t[14]||(t[14]=[c(" 생산 실적 등록 ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):(D(),R(S,{key:0},{default:a(()=>[e(u,{cols:"12"},{default:a(()=>[e(N,{elevation:"10"},{default:a(()=>[e(F,{fluid:""},{default:a(()=>[e(I,{class:"py-6 px-6"},{default:a(()=>[e(B,{title:"생산 지시건 선택"}),e(n(dt),{value:C.value,selectionMode:"single",selection:s.value,dataKey:"prodNo",paginator:"",rows:10,onRowSelect:W},{default:a(()=>[e(n(m),{field:"instructNo",header:"생산 지시 번호",sortable:""}),e(n(m),{field:"detaInstructNo",header:"세부 지시 번호",sortable:""}),e(n(m),{field:"instructDatetime",header:"지시 일자",sortable:""},{body:a(({data:d})=>[c(i(n(M)(d.instructDatetime)),1)]),_:1}),e(n(m),{field:"itemType",header:"생산 유형",sortable:""}),e(n(m),{field:"itemName",header:"품목명",sortable:""}),e(n(m),{field:"currentOpNo",header:"공정 순서",sortable:""}),e(n(m),{field:"prcsName",header:"현재 공정",sortable:""})]),_:1},8,["value","selection"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})),e(ot,{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=d=>y.value=d),"max-width":"520"},{default:a(()=>[e(N,{elevation:"12",class:"rounded-xl pa-4",color:"white"},{default:a(()=>[l("div",gt,[e(at,{size:"48",color:"grey-lighten-4"},{default:a(()=>[e(h,{size:"28",color:"primary"},{default:a(()=>t[15]||(t[15]=[c("mdi-alert-circle-outline")])),_:1})]),_:1}),t[16]||(t[16]=l("h3",{class:"text-h6 font-weight-bold mt-2"},"등록하시겠습니까?",-1))]),e(L,{density:"comfortable",class:"mb-4"},{default:a(()=>[l("tbody",null,[l("tr",null,[t[17]||(t[17]=l("td",{class:"font-weight-medium text-subtitle-1"},"생산 지시 번호",-1)),l("td",_t,i(s.value.instructNo),1)]),l("tr",null,[t[18]||(t[18]=l("td",{class:"font-weight-medium text-subtitle-1"},"세부 지시 번호",-1)),l("td",wt,i(s.value.detaInstructNo),1)]),l("tr",null,[t[19]||(t[19]=l("td",{class:"font-weight-medium text-subtitle-1"},"품목명",-1)),l("td",Nt,i(s.value.itemName),1)]),l("tr",null,[t[20]||(t[20]=l("td",{class:"font-weight-medium text-subtitle-1"},"투입 수량",-1)),l("td",kt,i(w(s.value.drctQty||0)),1)]),l("tr",null,[t[21]||(t[21]=l("td",{class:"font-weight-medium text-subtitle-1"},"불량 수량",-1)),l("td",Vt,i(O.value),1)]),l("tr",null,[t[22]||(t[22]=l("td",{class:"font-weight-medium text-subtitle-1"},"실제 생산 수량",-1)),l("td",Ct,i(T.value),1)])])]),_:1}),e(st,{class:"justify-end"},{default:a(()=>[e(k,{variant:"tonal",color:"grey-darken-1",rounded:"lg",onClick:t[0]||(t[0]=d=>y.value=!1)},{default:a(()=>t[23]||(t[23]=[c("취소")])),_:1}),e(k,{color:"primary",rounded:"lg",class:"ml-2 px-6",onClick:Y},{default:a(()=>t[24]||(t[24]=[c("확인")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(j,{visible:g.value,title:"설비 검색",idField:"prcsNumber",columns:[{key:"facilityId",label:"설비 번호"},{key:"facilityName",label:"설비명"}],fetchData:q,"page-size":5,onSelect:G,onClose:t[2]||(t[2]=d=>g.value=!1)},null,8,["visible"]),e(j,{visible:_.value,title:"사원 검색",idField:"emp_id",columns:[{key:"emp_id",label:"사원 번호"},{key:"emp_name",label:"사원 이름"}],fetchData:H,"page-size":5,onSelect:J,onClose:t[3]||(t[3]=d=>_.value=!1)},null,8,["visible"]),e(nt)],64))}},Tt=ct(Qt,[["__scopeId","data-v-ea3f1614"]]);export{Tt as default};

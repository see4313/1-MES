import{_ as q}from"./card-header-CLs5wgxG.js";import{_ as z}from"./card-header-btn2-BNncrG3u.js";import{s as T,a as i}from"./index-C6cMUqqj.js";import{_ as C}from"./CommonModal-eUFOkW9R.js";import{a as V}from"./index-NIGUFBhG.js";import"./dayjs.min-CQa8u9th.js";import{_ as L}from"./SnackBar-EkLInYn6.js";import{u as Q}from"./useSnackBar-CsLaRa2S.js";import{r as d,m as W,c as H,o as A,b as l,w as t,Q as S,T as y,U as u,ac as r,a0 as U,d as j,N as E,a as B,u as o,bh as G,t as J,F as K}from"./index-BkcQ_3tW.js";import"./_commonjsHelpers-gnU0ypJ3.js";const O={class:"card"},ue={__name:"itemExam",setup(X){const{snackBar:m}=Q(),n=d([]),k=d(!1),$=d(null),b=d(null),v=d(null),w=d(null),_=d(null),f=d(null),c=d(null),g=d(null),p=d(null);W(()=>{});const D=async()=>{try{const s={dept_id:"D004"};return(await V.get("/api/selectEmp",{params:s})).data}catch{return m("조회 실패.","error"),[]}},N=async()=>{try{return(await V.get("/api/prodList")).data}catch{return m("조회 실패.","error"),[]}},h=async s=>{c.value=s.rsrt_id,b.value=s.item_name,$.value=s.item_id,w.value=s.emp_id,_.value=s.emp_name,v.value=s.prod_qty,f.value=s.remk,p.value="불합격";try{const e={detail_sttus:"검수대기",item_id:s.item_id},a=await V.get("/api/examDetail",{params:e});n.value=a.data}catch{return m("조회 실패.","error"),[]}},F=s=>{w.value=s.emp_id,_.value=s.emp_name},I=()=>{c.value=null,b.value=null,v.value=null,_.value=null,f.value=null,p.value=null,n.value=[]},M=s=>{const e=n.value[s];e.judt_val===null||e.judt_val===void 0?e.detail_sttus="":e.detail_sttus=e.judt_val>=e.basi_val?"합격":"불합격";const a=n.value.every(x=>x.detail_sttus==="합격");p.value=a?"합격":"불합격"},R=async()=>{if(confirm("등록하시겠습니까?"))try{const s={rsrt_id:c.value,item_id:$.value,emp_id:w.value,sttus:p.value,exam_qty:v.value,remk:f.value,details:n.value.map(a=>({insp_id:a.insp_id,basi_val:a.basi_val,judt_val:a.judt_val,sttus:a.detail_sttus}))};(await V.post("/api/examHisInsert",s)).data.result?(m("등록 성공","success"),I(),n.value=[]):m("등록 실패.","error")}catch{m("에러","error")}};return(s,e)=>(A(),H(K,null,[l(E,{elevation:"10"},{default:t(()=>[l(S,{class:"py-6 px-6"},{default:t(()=>[l(z,{title:"제품 품질검사","btn-text1":"초기화","btn-variant1":"flat","btn-color1":"secondary",onBtnClick1:e[0]||(e[0]=a=>I()),"btn-text2":"등록","btn-variant2":"flat","btn-color2":"primary",onBtnClick2:e[1]||(e[1]=a=>R())}),l(y,null,{default:t(()=>[l(u,{cols:"12",md:"12"},{default:t(()=>[l(y,{justify:"space-between",dense:""},{default:t(()=>[l(u,{cols:"12",sm:"4"},{default:t(()=>[l(r,{label:"생산실적",modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=a=>c.value=a),variant:"outlined",readonly:""},{"append-inner":t(()=>[l(U,{onClick:e[2]||(e[2]=a=>g.value=!0),class:"cursor-pointer"},{default:t(()=>e[12]||(e[12]=[j("mdi-magnify")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(r,{label:"품목",modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=a=>b.value=a),variant:"outlined",readonly:""},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(r,{label:"수량",modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=a=>v.value=a),variant:"outlined",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(y,null,{default:t(()=>[l(u,{cols:"12",md:"12"},{default:t(()=>[l(y,{dense:""},{default:t(()=>[l(u,{cols:"12",sm:"4"},{default:t(()=>[l(r,{label:"담당자",modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=a=>_.value=a),variant:"outlined",readonly:""},{"append-inner":t(()=>[l(U,{onClick:e[6]||(e[6]=a=>k.value=!0),class:"cursor-pointer"},{default:t(()=>e[13]||(e[13]=[j("mdi-magnify")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(r,{label:"비고",modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=a=>f.value=a),variant:"outlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",sm:"4"},{default:t(()=>[l(r,{label:"결과",modelValue:p.value,"onUpdate:modelValue":e[9]||(e[9]=a=>p.value=a),variant:"outlined",readonly:"",style:{fontWeight:"bold"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(E,{elevation:"10",class:"mt-3"},{default:t(()=>[l(S,{class:"py-6 px-6"},{default:t(()=>[l(q,{title:"검사 목록"}),l(y,null,{default:t(()=>[l(u,{cols:"12",md:"12"},{default:t(()=>[B("div",O,[l(o(T),{value:n.value,paginator:"",rows:10,tableStyle:"min-width: 50rem; table-layout: fixed;"},{default:t(()=>[l(o(i),{field:"insp_id",header:"검사번호",style:{width:"180px"}}),l(o(i),{field:"insp_nm",header:"검사명",style:{width:"200px"}}),l(o(i),{field:"insp_mthd",header:"검사방식",style:{width:"150px"}}),l(o(i),{field:"insp_typ",header:"검사유형",style:{width:"100px"}}),l(o(i),{field:"basi_val",header:"기준값",style:{width:"100px"}}),l(o(i),{header:"측정값",style:{width:"100px"}},{body:t(a=>[l(r,{modelValue:n.value[a.index].judt_val,"onUpdate:modelValue":x=>n.value[a.index].judt_val=x,modelModifiers:{number:!0},type:"number",dense:"","hide-details":"",style:{width:"120px"},variant:"outlined",onInput:x=>M(a.index)},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1}),l(o(i),{field:"detail_sttus",header:"결과",style:{width:"100px"}},{body:t(a=>[B("span",{style:G({color:n.value[a.index].detail_sttus==="합격"?"green":n.value[a.index].detail_sttus==="불합격"?"red":"black",fontWeight:"bold"})},J(n.value[a.index].detail_sttus),5)]),_:1})]),_:1},8,["value"])])]),_:1})]),_:1})]),_:1})]),_:1}),l(C,{visible:k.value,title:"사원",idField:"emd_id",columns:[{key:"emp_id",label:"사원번호"},{key:"emp_name",label:"사원이름"}],fetchData:D,pageSize:5,onSelect:F,onClose:e[10]||(e[10]=a=>k.value=!1)},null,8,["visible"]),l(C,{visible:g.value,title:"생산실적",idField:"rsrt_id",columns:[{key:"rsrt_id",label:"실적번호"},{key:"item_id",label:"품목번호"},{key:"item_name",label:"품목명"},{key:"prod_qty",label:"생산 수량"}],fetchData:N,pageSize:5,onSelect:h,onClose:e[11]||(e[11]=a=>g.value=!1)},null,8,["visible"]),l(L)],64))}};export{ue as default};

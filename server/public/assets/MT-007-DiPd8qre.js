import{r as u,m as h,D as b,c as w,o as V,b as e,w as n,Q as k,T as x,U as g,u as a,d as D,t as M,be as q,bD as B,a as U,N as C,F as L}from"./index-vUQOwfGq.js";import{_ as T}from"./card-header-btn-CibSipEU.js";import{s as $,a as o,c as I}from"./index-DzeG4XAE.js";import{a as _}from"./index-NIGUFBhG.js";import{d as N}from"./dayjs.min-CQa8u9th.js";import{_ as S}from"./SnackBar-HH3n22ps.js";import{u as Y}from"./useSnackBar-IN_qynCK.js";import"./_commonjsHelpers-gnU0ypJ3.js";const j=["onUpdate:modelValue"],H={__name:"MT-007",setup(F){const{snackBar:i}=Y(),l=u(null),m=u(),c=u(null);h(()=>{f()}),b(l,s=>{s?c.value=s.lot_id:p()});function p(){l.value=null,c.value=null}const f=async()=>{try{const s={status:"폐기대기"},t=await _.get("/api/inventoryList",{params:s});m.value=t.data}catch{i("조회 실패.","error")}},y=async()=>{if(!l.value||l.value.length===0){i("폐기할 항목을 선택하세요.","warning");return}for(let t of l.value){if(!t.use_qty||t.use_qty<=0){i("폐기 수량을 입력하세요.","warning");return}if(!t.remk||t.remk.trim()===""){i("폐기 사유를 입력하세요.","warning");return}}let s=l.value.map(t=>({lot_id:t.lot_id,use_qty:t.use_qty,remk:t.remk}));try{(await _.post("/api/itemdispose",s).catch(r=>console.log(r))).data.result&&(i("처리되었습니다.","success"),f(),p())}catch{i("처리 실패.","error")}},v=s=>s?N(s).format("YYYY-MM-DD"):"";return(s,t)=>(V(),w(L,null,[e(C,{elevation:"10"},{default:n(()=>[e(k,{class:"py-6 px-6"},{default:n(()=>[e(T,{title:"폐기 대상","btn-text":"확정","btn-variant":"flat","btn-color":"primary",onBtnClick:t[0]||(t[0]=r=>y())}),e(x,null,{default:n(()=>[e(g,{cols:"12",md:"12"},{default:n(()=>[e(a($),{selection:l.value,"onUpdate:selection":t[1]||(t[1]=r=>l.value=r),value:m.value,selectionMode:"multiple",dataKey:"lot_id",paginator:"",rows:5,tableStyle:"min-width: 50rem",class:"cursor-pointer"},{default:n(()=>[e(a(o),{selectionMode:"multiple",headerStyle:"width: 3em"}),e(a(o),{field:"lot_id",sortable:"",header:"LOT번호"}),e(a(o),{field:"item_id",sortable:"",header:"품목번호"}),e(a(o),{field:"item_name",header:"품목명"}),e(a(o),{field:"item_type",header:"품목유형"}),e(a(o),{field:"wh_name",header:"위치"}),e(a(o),{field:"vald_date",sortable:"",header:"유효기한"},{body:n(({data:r})=>[D(M(v(r.vald_date)),1)]),_:1}),e(a(o),{field:"spec",header:"규격"}),e(a(o),{field:"bnt",header:"수량"}),e(a(o),{header:"폐기수량"},{body:n(({data:r})=>[e(a(I),{modelValue:r.use_qty,"onUpdate:modelValue":d=>r.use_qty=d,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(a(o),{header:"폐기사유"},{body:n(({data:r})=>[q(U("input",{"onUpdate:modelValue":d=>r.remk=d,type:"text",placeholder:"폐기 사유",class:"p-inputtext p-component"},null,8,j),[[B,r.remk]])]),_:1})]),_:1},8,["selection","value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(S)],64))}};export{H as default};

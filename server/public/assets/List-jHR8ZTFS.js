import{B as fe,r as v,c as ye,b as t,w as n,N as C,af as L,F as be,o as J,ag as ke,$ as we,d as p,ah as Y,V as f,a9 as ce,a2 as c,e as Ve,i as Ce,ai as Ye,aj as ze,T as Ue,U as P,ac as k,Z as Ne,ak as z,a as g,h as Te,t as R,O as S,a0 as E,ad as $e}from"./index-BkcQ_3tW.js";import{a as U}from"./index-NIGUFBhG.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ie={class:"font-weight-medium"},qe={class:"text-caption text-medium-emphasis"},Le=fe({__name:"List",setup(Pe){const K=$e(),i=v({facilityId:null,facilityName:"",type:"",typeLabel:"",managerId:"",managerName:"",useYn:"",useYnLabel:""}),N=v([]),F=v(0),V=v(!1),T=v(""),y=v(1),D=v(10),$=v([{key:"facility_name",order:"asc"}]),Q=[{title:"설비",key:"facility_name",sortable:!0},{title:"유형",key:"facility_type",sortable:!0,width:120},{title:"담당자",key:"manager_name",sortable:!0,width:150},{title:"사용여부",key:"use_yn",sortable:!0,width:110},{title:"작업",key:"actions",sortable:!1,width:120}],o=v({facility:!1,type:!1,manager:!1,useYn:!1}),W=[{title:"ID",key:"facility_id",width:80},{title:"설비명",key:"facility_nm"},{title:"코드",key:"facility_code"},{title:"유형",key:"facility_type",width:120},{title:"담당자",key:"manager_name",width:140},{title:"작업",key:"actions",width:100}],s=v({q:"",page:1,size:10,total:0,loading:!1,rows:[]});async function x(){s.value.loading=!0;try{const{data:a}=await U.get("/api/facilities",{params:{page:s.value.page,pageSize:s.value.size,q:s.value.q}});s.value.rows=(a==null?void 0:a.rows)??(a==null?void 0:a.items)??[],s.value.total=(a==null?void 0:a.total)??s.value.rows.length}finally{s.value.loading=!1}}let A;function X(){clearTimeout(A),A=setTimeout(()=>{s.value.page=1,x()},300)}function B(){o.value.facility=!0,x()}function _(a){i.value.facilityId=a.facility_id,i.value.facilityName=a.facility_nm||a.facility_name,o.value.facility=!1}function h(){i.value.facilityId=null,i.value.facilityName=""}const ee=[{title:"코드",key:"value",width:120},{title:"유형명",key:"label"},{title:"작업",key:"actions",width:100}],d=v({q:"",page:1,size:10,total:0,loading:!1,rows:[]});async function I(){d.value.loading=!0;try{const{data:a}=await U.get("/api/facility-types",{params:{page:d.value.page,pageSize:d.value.size,q:d.value.q}}),e=((a==null?void 0:a.rows)??(a==null?void 0:a.items)??[]).map(l=>({value:l.value??l.code??l.type_code,label:l.label??l.name??l.type_name}));d.value.rows=e,d.value.total=(a==null?void 0:a.total)??e.length}finally{d.value.loading=!1}}let j;function le(){clearTimeout(j),j=setTimeout(()=>{d.value.page=1,I()},300)}function ae(){o.value.type=!0,I()}function te(a){i.value.type=a.value||"",i.value.typeLabel=a.label||"",o.value.type=!1}function ne(){i.value.type="",i.value.typeLabel=""}const ie=[{title:"사번",key:"emp_id",width:120},{title:"이름",key:"emp_name"},{title:"부서",key:"dept_name"},{title:"작업",key:"actions",width:100}],r=v({q:"",page:1,size:10,total:0,loading:!1,rows:[]});async function q(){r.value.loading=!0;try{const{data:a}=await U.get("/api/employees",{params:{page:r.value.page,pageSize:r.value.size,q:r.value.q}}),e=((a==null?void 0:a.rows)??(a==null?void 0:a.items)??[]).map(l=>({emp_id:l.emp_id??l.EMP_ID,emp_name:l.emp_name??l.EMP_NM,dept_name:l.dept_name??l.DEPT_NAME}));r.value.rows=e,r.value.total=(a==null?void 0:a.total)??e.length}finally{r.value.loading=!1}}let O;function oe(){clearTimeout(O),O=setTimeout(()=>{r.value.page=1,q()},300)}function M(){o.value.manager=!0,q()}function se(a){i.value.managerId=a.emp_id,i.value.managerName=a.emp_name,o.value.manager=!1}function ue(){i.value.managerId="",i.value.managerName=""}const de=[{title:"값",key:"value",width:100},{title:"라벨",key:"label"},{title:"작업",key:"actions",width:100}],m=v({q:"",page:1,size:10,total:0,loading:!1,rows:[]});async function H(){m.value.loading=!0;try{const{data:a}=await U.get("/api/use-yn",{params:{page:m.value.page,pageSize:m.value.size,q:m.value.q}}),e=((a==null?void 0:a.rows)??(a==null?void 0:a.items)??[]).map(l=>({value:l.value??l.code??l.USE_YN,label:l.label??l.name??(l.USE_YN==="Y"?"사용":l.USE_YN==="N"?"미사용":String(l.USE_YN))}));m.value.rows=e,m.value.total=(a==null?void 0:a.total)??e.length}finally{m.value.loading=!1}}function re(){o.value.useYn=!0,H()}function pe(a){i.value.useYn=(a.value??"").toString(),i.value.useYnLabel=a.label??"",o.value.useYn=!1}function me(){i.value.useYn="",i.value.useYnLabel=""}async function w(){var l,b,G;V.value=!0,T.value="";const a=(l=$.value)==null?void 0:l[0],e={page:y.value,pageSize:D.value,facilityId:i.value.facilityId||"",type:i.value.type||"",managerId:i.value.managerId||"",useYn:i.value.useYn||"",sortBy:(a==null?void 0:a.key)||"",sortDesc:(a==null?void 0:a.order)==="desc"};try{const{data:u}=await U.get("/api/facilities",{params:e});N.value=(u==null?void 0:u.rows)??(u==null?void 0:u.items)??[],F.value=(u==null?void 0:u.total)??(u==null?void 0:u.count)??N.value.length}catch(u){T.value=((G=(b=u==null?void 0:u.response)==null?void 0:b.data)==null?void 0:G.message)||(u==null?void 0:u.message)||"조회 실패",N.value=[],F.value=0}finally{V.value=!1}}function Z(){y.value=1,w()}function ve(){i.value={facilityId:null,facilityName:"",type:"",typeLabel:"",managerId:"",managerName:"",useYn:"",useYnLabel:""},y.value=1,$.value=[{key:"facility_name",order:"asc"}],w()}function ge(a){K.push({name:"FacilityDetail",params:{id:a.facility_id}})}return w(),(a,e)=>(J(),ye(be,null,[t(C,{elevation:"10"},{default:n(()=>[t(ke,{color:"transparent",flat:"",class:"px-6 pt-4"},{default:n(()=>[t(we,{class:"text-h6"},{default:n(()=>e[33]||(e[33]=[p("설비목록 조회")])),_:1}),t(Y),t(f,{variant:"flat",color:"grey",class:"mr-2",onClick:ve,disabled:V.value},{default:n(()=>e[34]||(e[34]=[p("초기화")])),_:1},8,["disabled"]),t(f,{variant:"flat",color:"primary",onClick:Z,loading:V.value},{default:n(()=>e[35]||(e[35]=[p("조회")])),_:1},8,["loading"])]),_:1}),t(ce),t(c,{class:"pt-6"},{default:n(()=>[t(Ye,{onSubmit:ze(Z,["prevent"])},{default:n(()=>[t(Ue,{dense:""},{default:n(()=>[t(P,{cols:"12",sm:"3"},{default:n(()=>[t(k,{label:"설비명/코드",variant:"outlined",readonly:"",value:i.value.facilityName,placeholder:"설비 선택","prepend-inner-icon":"mdi-magnify","append-inner-icon":"mdi-menu-down",onClick:e[0]||(e[0]=l=>B()),"onClick:prependInner":e[1]||(e[1]=l=>B()),"onClick:appendInner":e[2]||(e[2]=l=>B()),clearable:"","onClick:clear":h},null,8,["value"])]),_:1}),t(P,{cols:"12",sm:"3"},{default:n(()=>[t(k,{label:"설비유형",variant:"outlined",readonly:"",value:i.value.typeLabel||"전체",placeholder:"전체","append-inner-icon":"mdi-menu-down",onClick:e[3]||(e[3]=l=>ae()),clearable:"","onClick:clear":ne},null,8,["value"])]),_:1}),t(P,{cols:"12",sm:"3"},{default:n(()=>[t(k,{label:"담당자",variant:"outlined",readonly:"",value:i.value.managerName,placeholder:"담당자 선택","prepend-inner-icon":"mdi-magnify","append-inner-icon":"mdi-menu-down",onClick:e[4]||(e[4]=l=>M()),"onClick:prependInner":e[5]||(e[5]=l=>M()),"onClick:appendInner":e[6]||(e[6]=l=>M()),clearable:"","onClick:clear":ue},null,8,["value"])]),_:1}),t(P,{cols:"12",sm:"3"},{default:n(()=>[t(k,{label:"사용여부",variant:"outlined",readonly:"",value:i.value.useYnLabel||"전체",placeholder:"전체","append-inner-icon":"mdi-menu-down",onClick:e[7]||(e[7]=l=>re()),clearable:"","onClick:clear":me},null,8,["value"])]),_:1})]),_:1})]),_:1}),T.value?(J(),Ve(Ne,{key:0,type:"error",class:"mt-3",text:T.value,density:"comfortable",border:"start"},null,8,["text"])):Ce("",!0)]),_:1}),t(c,null,{default:n(()=>[t(z,{headers:Q,items:N.value,"items-length":F.value,loading:V.value,page:y.value,"items-per-page":D.value,"sort-by":$.value,"multi-sort":!1,class:"mt-2","onUpdate:page":e[8]||(e[8]=l=>{y.value=l,w()}),"onUpdate:itemsPerPage":e[9]||(e[9]=l=>{D.value=l,y.value=1,w()}),"onUpdate:sortBy":e[10]||(e[10]=l=>{$.value=l,y.value=1,w()})},{"item.facility_name":n(({item:l})=>[g("div",Ie,R(l.facility_name),1),g("div",qe,R(l.facility_code),1)]),"item.use_yn":n(({item:l})=>[t(Te,{color:l.use_yn==="Y"?"success":"grey",size:"small",variant:"flat"},{default:n(()=>[p(R(l.use_yn==="Y"?"사용":"미사용"),1)]),_:2},1032,["color"])]),"item.actions":n(({item:l})=>[t(f,{size:"small",variant:"tonal",color:"primary",onClick:b=>ge(l)},{default:n(()=>e[36]||(e[36]=[p("상세")])),_:2},1032,["onClick"])]),loading:n(()=>e[37]||(e[37]=[g("div",{class:"pa-6 text-center"},"불러오는 중…",-1)])),"no-data":n(()=>e[38]||(e[38]=[g("div",{class:"pa-6 text-center"},"데이터가 없습니다.",-1)])),_:1},8,["items","items-length","loading","page","items-per-page","sort-by"])]),_:1})]),_:1}),t(L,{modelValue:o.value.facility,"onUpdate:modelValue":e[16]||(e[16]=l=>o.value.facility=l),"max-width":"900",contained:""},{default:n(()=>[t(C,{class:"rounded-lg"},{default:n(()=>[t(S,{class:"text-h6 font-weight-bold"},{default:n(()=>[e[40]||(e[40]=p(" 설비 선택 ")),t(Y),t(f,{icon:"",onClick:e[11]||(e[11]=l=>o.value.facility=!1)},{default:n(()=>[t(E,null,{default:n(()=>e[39]||(e[39]=[p("mdi-close")])),_:1})]),_:1})]),_:1}),t(c,null,{default:n(()=>[t(k,{modelValue:s.value.q,"onUpdate:modelValue":[e[12]||(e[12]=l=>s.value.q=l),e[13]||(e[13]=l=>X())],variant:"outlined",density:"comfortable",placeholder:"설비명/코드 검색","prepend-inner-icon":"mdi-magnify",clearable:"",class:"mb-3"},null,8,["modelValue"]),t(z,{headers:W,items:s.value.rows,"items-length":s.value.total,loading:s.value.loading,page:s.value.page,"items-per-page":s.value.size,"onUpdate:page":e[14]||(e[14]=l=>{s.value.page=l,x()}),"onUpdate:itemsPerPage":e[15]||(e[15]=l=>{s.value.size=l,s.value.page=1,x()})},{"item.actions":n(({item:l})=>[t(f,{size:"small",color:"primary",variant:"tonal",onClick:b=>_(l)},{default:n(()=>e[41]||(e[41]=[p("선택")])),_:2},1032,["onClick"])]),loading:n(()=>e[42]||(e[42]=[g("div",{class:"pa-6 text-center"},"불러오는 중…",-1)])),"no-data":n(()=>e[43]||(e[43]=[g("div",{class:"pa-6 text-center"},"자료가 없습니다",-1)])),_:1},8,["items","items-length","loading","page","items-per-page"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(L,{modelValue:o.value.type,"onUpdate:modelValue":e[22]||(e[22]=l=>o.value.type=l),"max-width":"700",contained:""},{default:n(()=>[t(C,{class:"rounded-lg"},{default:n(()=>[t(S,{class:"text-h6 font-weight-bold"},{default:n(()=>[e[45]||(e[45]=p(" 설비유형 선택 ")),t(Y),t(f,{icon:"",onClick:e[17]||(e[17]=l=>o.value.type=!1)},{default:n(()=>[t(E,null,{default:n(()=>e[44]||(e[44]=[p("mdi-close")])),_:1})]),_:1})]),_:1}),t(c,null,{default:n(()=>[t(k,{modelValue:d.value.q,"onUpdate:modelValue":[e[18]||(e[18]=l=>d.value.q=l),e[19]||(e[19]=l=>le())],variant:"outlined",density:"comfortable",placeholder:"유형명/코드 검색","prepend-inner-icon":"mdi-magnify",clearable:"",class:"mb-3"},null,8,["modelValue"]),t(z,{headers:ee,items:d.value.rows,"items-length":d.value.total,loading:d.value.loading,page:d.value.page,"items-per-page":d.value.size,"onUpdate:page":e[20]||(e[20]=l=>{d.value.page=l,I()}),"onUpdate:itemsPerPage":e[21]||(e[21]=l=>{d.value.size=l,d.value.page=1,I()})},{"item.actions":n(({item:l})=>[t(f,{size:"small",color:"primary",variant:"tonal",onClick:b=>te(l)},{default:n(()=>e[46]||(e[46]=[p("선택")])),_:2},1032,["onClick"])]),loading:n(()=>e[47]||(e[47]=[g("div",{class:"pa-6 text-center"},"불러오는 중…",-1)])),"no-data":n(()=>e[48]||(e[48]=[g("div",{class:"pa-6 text-center"},"자료가 없습니다",-1)])),_:1},8,["items","items-length","loading","page","items-per-page"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(L,{modelValue:o.value.manager,"onUpdate:modelValue":e[28]||(e[28]=l=>o.value.manager=l),"max-width":"800",contained:""},{default:n(()=>[t(C,{class:"rounded-lg"},{default:n(()=>[t(S,{class:"text-h6 font-weight-bold"},{default:n(()=>[e[50]||(e[50]=p(" 담당자 선택 ")),t(Y),t(f,{icon:"",onClick:e[23]||(e[23]=l=>o.value.manager=!1)},{default:n(()=>[t(E,null,{default:n(()=>e[49]||(e[49]=[p("mdi-close")])),_:1})]),_:1})]),_:1}),t(c,null,{default:n(()=>[t(k,{modelValue:r.value.q,"onUpdate:modelValue":[e[24]||(e[24]=l=>r.value.q=l),e[25]||(e[25]=l=>oe())],variant:"outlined",density:"comfortable",placeholder:"이름/사번 검색","prepend-inner-icon":"mdi-magnify",clearable:"",class:"mb-3"},null,8,["modelValue"]),t(z,{headers:ie,items:r.value.rows,"items-length":r.value.total,loading:r.value.loading,"item-key":"emp_id",page:r.value.page,"items-per-page":r.value.size,"onUpdate:page":e[26]||(e[26]=l=>{r.value.page=l,q()}),"onUpdate:itemsPerPage":e[27]||(e[27]=l=>{r.value.size=l,r.value.page=1,q()})},{"item.actions":n(({item:l})=>[t(f,{size:"small",color:"primary",variant:"tonal",onClick:b=>se(l)},{default:n(()=>e[51]||(e[51]=[p("선택")])),_:2},1032,["onClick"])]),loading:n(()=>e[52]||(e[52]=[g("div",{class:"pa-6 text-center"},"불러오는 중…",-1)])),"no-data":n(()=>e[53]||(e[53]=[g("div",{class:"pa-6 text-center"},"자료가 없습니다",-1)])),_:1},8,["items","items-length","loading","page","items-per-page"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(L,{modelValue:o.value.useYn,"onUpdate:modelValue":e[32]||(e[32]=l=>o.value.useYn=l),"max-width":"500",contained:""},{default:n(()=>[t(C,{class:"rounded-lg"},{default:n(()=>[t(S,{class:"text-h6 font-weight-bold"},{default:n(()=>[e[55]||(e[55]=p(" 사용여부 선택 ")),t(Y),t(f,{icon:"",onClick:e[29]||(e[29]=l=>o.value.useYn=!1)},{default:n(()=>[t(E,null,{default:n(()=>e[54]||(e[54]=[p("mdi-close")])),_:1})]),_:1})]),_:1}),t(c,null,{default:n(()=>[t(z,{headers:de,items:m.value.rows,"items-length":m.value.total,loading:m.value.loading,page:m.value.page,"items-per-page":m.value.size,"onUpdate:page":e[30]||(e[30]=l=>{m.value.page=l,H()}),"onUpdate:itemsPerPage":e[31]||(e[31]=l=>{m.value.size=l,m.value.page=1,H()})},{"item.actions":n(({item:l})=>[t(f,{size:"small",color:"primary",variant:"tonal",onClick:b=>pe(l)},{default:n(()=>e[56]||(e[56]=[p("선택")])),_:2},1032,["onClick"])]),loading:n(()=>e[57]||(e[57]=[g("div",{class:"pa-6 text-center"},"불러오는 중…",-1)])),"no-data":n(()=>e[58]||(e[58]=[g("div",{class:"pa-6 text-center"},"자료가 없습니다",-1)])),_:1},8,["items","items-length","loading","page","items-per-page"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),De=xe(Le,[["__scopeId","data-v-4051daeb"]]);export{De as default};
